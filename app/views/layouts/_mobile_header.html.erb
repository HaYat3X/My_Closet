<nav class="navbar mobile-header header fixed-top">
    <button type="button" class="hamburger" data-bs-toggle="offcanvas" data-bs-target="#Navbar" aria-expanded="false" aria-controls="offcanvasNavbar" aria-label="ナビゲーションの切替">
        <%= image_tag "/assets/icons/icn_menu.png" %>
    </button>

    <a class="navbar-brand logo-area" href="/">
        <%= image_tag "/assets/logos/logo1.png", class: "logo-img" %>
    </a>

    <% if current_page?(root_path) || current_page?("/sns/show/#{params[:id]}") || current_page?(sns_search_path) || current_page?(sns_new_path) || current_page?("/sns/edit/#{params[:id]}")  %>
        <button type="button" class="search-btn" id="delayed-search-btn" data-bs-toggle="collapse" data-bs-target="#collapseSns" aria-expanded="false" aria-controls="collapseExample">
            <img src="/assets/icons/icn_search_w.png" alt="">
        </button>

        <a href="/alert/list" class="alert-area">
            <img src="/assets/icons/icn_bell.png" class="bell-img" alt="">

            <% if @number_of_notifications.count != 0 %>
                <span class="rounded-pill text-bg-danger">
                    <small>
                        <% if @number_of_notifications.count >= 99 %>
                            99+
                        <% else %>
                            <%= @number_of_notifications.count %>
                        <% end %>
                    </small>
                </span>
            <% end %>
        </a>

        <div class="collapse p-2" id="collapseSns" style="background-color: #222222; border-radius: 5px; width: 100%; margin-top: 5px;">
            <%= form_with(url: "/sns/search", local: true, method: :get, class: "d-flex ms-auto") do |f| %>
                <div class="input-group">
                    <%= f.text_field :search, class: "form-control", placeholder: "search", required: true, id: "search" %>

                    <%= f.button class: "btn bg-white btn-white", type: :submit do %>
                        <i class="bi bi-search"></i>
                    <% end %>
                </div>
            <% end %>
        </div>
    <% elsif current_page?("/closet/list") || current_page?("/closet/show/#{params[:id]}") || current_page?("/closet/search") || current_page?("/closet/new") || current_page?("/closet/edit/#{params[:id]}") %>
        <button type="button" class="search-btn" data-bs-toggle="collapse" data-bs-target="#collapseCloset" aria-expanded="false" aria-controls="collapseExample">
            <img src="/assets/icons/icn_search_w.png" alt="">
        </button>

        <a href="/alert/list" class="alert-area">
            <img src="/assets/icons/icn_bell.png" class="bell-img" alt="">

            <% if @number_of_notifications.count != 0 %>
                <span class="rounded-pill text-bg-danger">
                    <small>
                        <% if @number_of_notifications.count >= 99 %>
                            99+
                        <% else %>
                            <%= @number_of_notifications.count %>
                        <% end %>
                    </small>
                </span>
            <% end %>
        </a>

        <div class="collapse p-2" id="collapseCloset" style="background-color: #222222; width: 100%; margin-top: 5px; border-radius: 5px;">
            <%= form_with(url: "/closet/search", local: true, method: :get, class: "d-flex ms-auto") do |f| %>
                <div class="input-group">
                    <%= f.text_field :search, class: "form-control", placeholder: "search", required: true %>

                    <%= f.button class: "btn bg-white btn-white", type: :submit do %>
                        <i class="bi bi-search"></i>
                    <% end %>
                </div>
            <% end %>
        </div>
    <% elsif current_page?("/faq/question/list") || current_page?("/faq/question/search") || current_page?("/faq/question/new") || current_page?("/faq/question/show/#{params[:id]}") || current_page?("/faq/question/edit/#{params[:id]}") %>
        <button type="button" class="search-btn" data-bs-toggle="collapse" data-bs-target="#collapseFaq" aria-expanded="false" aria-controls="collapseExample">
            <img src="/assets/icons/icn_search_w.png" alt="">
        </button>

        <a href="/alert/list" class="alert-area">
            <img src="/assets/icons/icn_bell.png" class="bell-img" alt="">        

            <% if @number_of_notifications.count != 0 %>
                <span class="rounded-pill text-bg-danger">
                    <small>
                        <% if @number_of_notifications.count >= 99 %>
                            99+
                        <% else %>
                            <%= @number_of_notifications.count %>
                        <% end %>
                    </small>
                </span>
            <% end %>
        </a>

        <div class="collapse p-2" id="collapseFaq" style="background-color: #222222; width: 100%; margin-top: 5px; border-radius: 5px;">
            <%= form_with(url: "/faq/question/search", local: true, method: :get, class: "d-flex ms-auto") do |f| %>
                <div class="input-group">
                    <%= f.text_field :search, class: "form-control", placeholder: "search" %>

                    <%= f.button class: "btn bg-white btn-white", type: :submit do %>
                        <i class="bi bi-search"></i>
                    <% end %>
                </div>
            <% end %>
        </div>
    <% else %>
        <a href="/alert/list" class="alert-area" style="margin-left: 25px;">
            <img src="/assets/icons/icn_bell.png" class="bell-img" alt="">        

            <% if @number_of_notifications.count != 0 %>
                <span class="rounded-pill text-bg-danger">
                    <small>
                        <% if @number_of_notifications.count >= 99 %>
                            99+
                        <% else %>
                            <%= @number_of_notifications.count %>
                        <% end %>
                    </small>
                </span>
            <% end %>
        </a>
    <% end %>

    <div class="sidebar offcanvas offcanvas-start" tabindex="-1" id="Navbar" aria-labelledby="offcanvasNavbarLabel">
        <div class="d-flex flex-column flex-shrink-0 sticky-top">
            <div class="text-end">
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="閉じる"></button>
            </div>

            <ul class="nav nav-pills flex-column">
                <label>メニュー</label>

                <li class="nav-item">
                    <% if current_page?(root_path) || current_page?("/sns/show/#{params[:id]}") || current_page?(sns_search_path) || current_page?(sns_new_path) || current_page?("/sns/edit/#{params[:id]}") %>
                        <a href="/" class="d-flex align-items-center active" aria-current="page">
                            <img src="/assets/icons/icn_home.png" alt="">
                            ホーム
                        </a>
                    <% else %>
                        <a href="/" class="d-flex align-items-center" aria-current="page">
                            <img src="/assets/icons/icn_home_b.png" alt="">
                            ホーム
                        </a>
                    <% end %>
                </li>

                <li class="nav-item">
                    <% if current_page?("/suggestion") || current_page?("/induction") %>
                        <% if user_signed_in? %>
                            <% if Suggest.exists?(user_id: current_user.id) %>
                                <a href="/suggestion" class="d-flex align-items-center active">
                                    <img src="/assets/icons/icn_AI_w.png" alt="">
                                    コーディネート提案
                                </a>
                            <% else %>
                                <a href="/induction" class="d-flex align-items-center active">
                                    <img src="/assets/icons/icn_AI_w.png" alt="">
                                    コーディネート提案
                                </a>
                            <% end %>
                        <% else %>
                            <a href="/suggestion" class="d-flex align-items-center active">
                                <img src="/assets/icons/icn_AI_w.png" alt="">
                                コーディネート提案
                            </a>
                        <% end %>
                    <% else %>
                        <% if user_signed_in? %>
                            <% if Suggest.exists?(user_id: current_user.id) %>
                                <a href="/suggestion" class="d-flex align-items-center">
                                    <img src="/assets/icons/icn_AI.png" alt="">
                                    コーディネート提案
                                </a>
                            <% else %>
                                <a href="/induction" class="d-flex align-items-center">
                                    <img src="/assets/icons/icn_AI.png" alt="">
                                    コーディネート提案
                                </a>
                            <% end %>
                        <% else %>
                            <a href="/suggestion" class="d-flex align-items-center">
                                <img src="/assets/icons/icn_AI.png" alt="">
                                コーディネート提案
                            </a>
                        <% end %>
                    <% end %>
                </li>

                <li class="nav-item">
                    <% if current_page?("/sns/like_ranking") %>
                        <a href="/sns/like_ranking" class="d-flex align-items-center active">
                            <img src="/assets/icons/icn_ranking_w.png" alt="">
                            ランキング
                        </a>
                    <% else %>
                        <a href="/sns/like_ranking" class="d-flex align-items-center">
                            <img src="/assets/icons/icn_ranking.png" alt="">
                            ランキング
                        </a>
                    <% end %>
                </li>

                <li class="nav-item">
                    <% if user_signed_in? %>
                        <%# * ユーザーがログインしているかの判定をする %>
                        <% if current_page?("/profile/show/#{params[:id]}") || current_page?("/profile/edit/#{params[:id]}") ||  current_page?("/follow/#{params[:id]}") %>
                            <%= link_to "/profile/show/#{current_user.id}", class: "d-flex align-items-center active" do %>
                                <img src="/assets/icons/icn_user_w.png" alt="">
                                マイページ
                            <% end %>
                        <% else %>
                            <%= link_to "/profile/show/#{current_user.id}", class: "d-flex align-items-center" do %>
                                <img src="/assets/icons/icn_user.png" alt="">
                                マイページ
                            <% end %>
                        <% end %>
                    <% end %>
                </li>

                <li class="nav-item">
                    <% if current_page?("/closet/list") || current_page?("/closet/show/#{params[:id]}") || current_page?("/closet/search") || current_page?("/closet/new") || current_page?("/closet/edit/#{params[:id]}") %>
                        <a href="/closet/list" class="d-flex align-items-center active">
                            <img src="/assets/icons/icn_closet_w.png" alt="">
                            クローゼット
                        </a>
                    <% else %>
                        <a href="/closet/list" class="d-flex align-items-center">
                            <img src="/assets/icons/icn_closet.png" alt="">
                            クローゼット
                        </a>
                    <% end %>
                </li>

                <li class="nav-item">
                    <% if current_page?("/faq/question/list") || current_page?("/faq/question/search") || current_page?("/faq/question/new") || current_page?("/faq/question/show/#{params[:id]}") || current_page?("/faq/question/edit/#{params[:id]}") || current_page?("/faq/answer/new/#{params[:id]}") || current_page?("/faq/answer/edit/#{params[:id]}") %>
                        <a href="/faq/question/list" class="d-flex align-items-center active">
                            <img src="/assets/icons/icn_advice_w.png" alt="">
                            コーディネートQ&A
                        </a>
                    <% else %>
                        <a href="/faq/question/list" class="d-flex align-items-center">
                            <img src="/assets/icons/icn_faq.png" alt="">
                            コーディネートQ&A
                        </a>
                    <% end %>
                </li>

                <hr>
                
                <% if current_page?(root_path) || current_page?("/sns/show/#{params[:id]}") || current_page?(sns_search_path) || current_page?(sns_new_path) || current_page?("/sns/edit/#{params[:id]}") %>
                    <li class="post-btn">
                        <a href="/sns/new" class="rounded-pill col-12 d-flex align-items-center justify-content-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 21 21" fill="none">
                                <path d="M16.3337 11.3334H11.3337V16.3334H9.66699V11.3334H4.66699V9.66675H9.66699V4.66675H11.3337V9.66675H16.3337V11.3334Z" fill="#FAFBFC"/>
                            </svg>
                            コーディネート投稿
                        </a>
                    </li>
                <% elsif current_page?("/closet/list") || current_page?("/closet/show/#{params[:id]}") || current_page?("/closet/search") || current_page?("/closet/new") || current_page?("/closet/edit/#{params[:id]}") %>
                    <li class="post-btn">
                        <a href="/closet/new" class="rounded-pill col-12 d-flex align-items-center justify-content-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 21 21" fill="none">
                                <path d="M16.3337 11.3334H11.3337V16.3334H9.66699V11.3334H4.66699V9.66675H9.66699V4.66675H11.3337V9.66675H16.3337V11.3334Z" fill="#FAFBFC"/>
                            </svg>
                            アイテム追加
                        </a>
                    </li>
                <% elsif current_page?("/faq/question/list") || current_page?("/faq/question/search") || current_page?("/faq/question/new") || current_page?("/faq/question/show/#{params[:id]}") || current_page?("/faq/question/edit/#{params[:id]}") %>
                    <li class="post-btn">
                        <a href="/faq/question/new" class="rounded-pill col-12 d-flex align-items-center justify-content-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 21 21" fill="none">
                                <path d="M16.3337 11.3334H11.3337V16.3334H9.66699V11.3334H4.66699V9.66675H9.66699V4.66675H11.3337V9.66675H16.3337V11.3334Z" fill="#FAFBFC"/>
                            </svg>
                            質問を投稿
                        </a>
                    </li>
                <% end %>
                    
                <% if current_page?(root_path) || current_page?("/sns/show/#{params[:id]}") || current_page?(sns_search_path) || current_page?(sns_new_path) || current_page?("/sns/edit/#{params[:id]}")  %>
                    <div class="search-identification">
                        <label>ブランドで検索</label><br>

                        <li class="nav-item">
                            <a href="/sns/search?search=UNIQLO">UNIQLO</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=GU">GU</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=H＆M">H＆M</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=ZARA">ZARA</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=WEGO">WEGO</a>
                        </li>
                        
                        <li class="nav-item">
                            <a href="/sns/search?search=NIKE">NIKE</a>
                        </li>
                        
                        <li class="nav-item">
                            <a href="/sns/search?search=ADIDAS">ADIDAS</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=GAP">GAP</a>
                        </li>
                            
                        <li class="nav-item">
                            <a href="/sns/search?search=LOWRYSFARM">LOWRYSFARM</a>
                        </li>

                        <label>季節で検索</label><br>

                        <li class="nav-item">
                            <a href="/sns/search?search=春">春（3月〜5月）</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=夏">夏（6月〜8月）</a>
                        </li>
                            
                        <li class="nav-item">
                            <a href="/sns/search?search=秋">秋（9月〜11月）</a>
                        </li>
                            
                        <li class="nav-item">
                            <a href="/sns/search?search=冬">冬（12月〜2月）</a>
                        </li>
                            
                        <label>身長で検索</label><br>

                        <li class="nav-item">
                            <a href="/sns/search?search=~149cm">~149cm</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=150cm~159cm">150cm~159cm</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=160cm~169cm">160cm~169cm</a>
                        </li>

                        <li class="nav-item">
                            <a href="/sns/search?search=170cm~179cm">170~179cm</a>
                        </li>    

                        <li class="nav-item">
                            <a href="/sns/search?search=180cm~">180cm~</a>
                        </li>       
                    </div>

                    <hr>
                <% end %>

                <% if current_page?("/faq/question/list") || current_page?("/faq/question/search") || current_page?("/faq/question/new") || current_page?("/faq/question/show/#{params[:id]}") || current_page?("/faq/question/edit/#{params[:id]}")  %>
                <div class="search-identification">
                        <label>カテゴリーで検索</label><br>

                        <li class="nav-item">
                            <a href="/faq/question/search?search=着回し相談">着回し相談</a>
                        </li>

                        <li class="nav-item">
                            <a href="/faq/question/search?search=コーディネート相談">コーディネート相談</a>
                        </li>

                        <li class="nav-item">
                            <a href="/faq/question/search?search=購入相談">購入相談</a>
                        </li>  
                    </div>
                <% end %>

                <label style="margin-top: 80px;">その他</label>

                <li class="nav-item">
                    <% if current_page?("/sns/special") %>
                        <a href="/sns/special" class="d-flex align-items-center active">
                            <img src="/assets/icons/icn_contact_w.png" alt="">
                            学園祭特設ページ
                        </a>
                    <% else %>
                        <a href="/sns/special" class="d-flex align-items-center">
                            <img src="/assets/icons/icn_contact.png" alt="">
                            学園祭特設ページ
                        </a>
                    <% end %>
                </li>

                <li class="nav-item">
                    <% if current_page?("/contact/new") || current_page?("/contact/complete") %>
                        <a href="/contact/new" class="d-flex align-items-center active">
                            <img src="/assets/icons/icn_contact_w.png" alt="">
                            お問い合わせ
                        </a>
                    <% else %>
                        <a href="/contact/new" class="d-flex align-items-center">
                            <img src="/assets/icons/icn_contact.png" alt="">
                            お問い合わせ
                        </a>
                    <% end %>
                </li>

                    
                <li class="nav-item pb-3">
                    <%# * ユーザーがログインしているかの判定をする %>
                    <% if user_signed_in? %>
                        <%= link_to destroy_user_session_path, method: :delete, class: "d-flex align-items-center" do %>
                            <img src="/assets/icons/icn_user.png" alt="">
                            ログアウト
                        <% end %>
                    <% else %>
                        <%= link_to new_user_session_path, method: :get, class: "d-flex align-items-centerb" do %>
                            <img src="/assets/icons/icn_user.png" alt="">
                            ログイン
                        <% end %>
                    <% end %>
                </li>
            </ul>
        </div>
    </div>
</nav>