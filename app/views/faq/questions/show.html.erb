<div id="question_list">
    <%# ! header %>
    <%= render "faq/layouts/header" %>
    <div class="d-flex">
        <%# ! sidebar %>
        <div class="col-lg-3">
            <%= render "faq/layouts/sidebar" %>
        </div>

        <%# ! contents %>
        <div class="list_content col-lg-9">
                <div class="bg-white p-3 m-5">
                    <div class="row">
                        <div class="col-lg-2">
                            <%= image_tag @question.photograph.url, class: "question_image" %>
                        </div>
                        <div class="col-lg-10">
                            <div class="d-flex m-3">
                                <%= image_tag @question.photograph.url, size: "40x40" %>
                                <p class="fw-bold"><%= @question.user.user_name %></p>
                            </div>
                            <p class="m-3">
                                <%= @question.question %>
                            </p>
                            <%= link_to "編集", "/question/edit/#{@question.id}" %>
                        <%= button_to "削除", "/question/delete/#{@question.id}", method: :delete %>
                        </div>
                    </div>
                </div>
                <div class="m-5">
                    <div class="list_content col-lg-9">
                <% if @answer.errors.any? %>
                    <div class="alert alert-danger" role="alert">
                        <% @answer.errors.each do |error| %>
                        <strong>エラー！</strong> - <%= error.full_message %><br>
                        <% end %>
                    </div>
    <% end %>

    <%= form_with(model: @answer, url: "/faq/answer/create/#{@question.id}", local: true, :html => {class:"needs-validation", :novalidate => true}) do |f| %>
                  <div class="mb-3">
                    <%= f.file_field :photograph, class: "form-control", placeholder: "写真" %>
                  </div>
                  <div class="mb-3">
                    <%= f.text_area :answer, class: "form-control", placeholder: "回答内容" %>
                  </div>
                  <div class="mb-3">
                  </div>
                  <%= f.submit "登録する", class: "btn btn-primary" %>
                <% end %>
                </div>

                <div class="p-3 m-5">
                <% @answers.each do |a| %>
                    <div class="bg-white row m-3">
                        <div class="col-lg-2">
                            <% if a.photograph.url %>
                                <%= image_tag a.photograph.url, class: "question_image" %>
                            <% end %>
                        </div>
                        <div class="col-lg-10">
                            <div class="d-flex m-3">
                                <%= image_tag "/assets/img_1.png", size: "40x40" %>
                                <p class="fw-bold"><%= a.user.user_name %></p>
                            </div>
                            <p class="m-3">
                                <%= a.answer %>
                                <%= link_to "編集", "/faq/answer/edit/#{a.id}" %>
                                <%= button_to "削除", "/faq/answer/delete/#{a.id}", method: :delete %>
                            </p>





                            <% if AnswerLike.where(user_id: current_user.id, answer_id: a.id).exists? %>
                                <%= button_to "いいねかいじょ", "/faq/create_delete/#{a.id}", method: :delete %>

                            <% else %>
                                <%= button_to "いいね", "/faq/create_like/#{a.id}", method: :post %>
                            <% end %>
                            <%= AnswerLike.where(user_id: current_user.id, answer_id: a.id).count %>

                        </div>
                    </div>
                <% end %>
                </div>
        </div>
    </div>
</div>
